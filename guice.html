<!--
   Licensed to the Apache Software Foundation (ASF) under one or more
   contributor license agreements.  See the NOTICE file distributed with
   this work for additional information regarding copyright ownership.
   The ASF licenses this file to You under the Apache License, Version 2.0
   (the "License"); you may not use this file except in compliance with
   the License.  You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-  2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
-->
<html>




























<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="Apache Shiro is a powerful and easy-to-use Java security framework that performs authentication, authorization, cryptography, and session management.">
    <meta name="google-site-verification" content="QIax6uT5UX3enoU0G8Pz2pXbQ45KaQuHZ3nCh9V27mw">
    <meta name="google-site-verification" content="ecFap6dWJgS_GCCtxmJQJ_nFYQhM6EgSpBPZDU7xsCE">
    <meta name="msvalidate.01" content="0B57EB46CBFAD8FD45008D2DB6B6C68C">
    <meta name="y_key" content="e47896cd6bae4920">
    <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml">

    <title>
                    Apache Shiro | Simple. Java. Security.
        </title>


    <link rel="icon" type="image/vnd.microsoft.icon" href="./assets/images/favicon.ico">
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">

    <!-- site styles and  -->
    <link rel="stylesheet" type="text/css" href="./assets/css/style.css">
    <script type="text/javascript" src="./assets/js/shiro-site.js"></script>

    <!-- github ribbon -->
    <link rel="stylesheet" href="./assets/css/gh-pages/gh-fork-ribbon.css" />
    <!--[if lt IE 9]>
      <link rel="stylesheet" href="./assets/css/gh-pages/gh-fork-ribbon.ie.css" />
    <![endif]-->

    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>

    <!-- bootstrap -->
    <link rel="stylesheet" href="./assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="./assets/bootstrap/css/bootstrap-theme.min.css">
    <script src="./assets/bootstrap/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="./assets/css/bootstrap-social.css">

    <!-- Google Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXX-Y', 'auto');
    ga('send', 'pageview');
    </script>
    <!-- End Google Analytics -->



    <!-- syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/styles/default.min.css" integrity="sha256-Zd1icfZ72UBmsId/mUcagrmN7IN5Qkrvh75ICHIQVTk=" crossorigin="anonymous" />
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/highlight.min.js" integrity="sha256-s63qpgPYoQk+wv3U6WZqioVJrwFNBTgD4dkeegLuwvo=" crossorigin="anonymous"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <script type="text/javascript">

        $( document ).ready(function() {
            addPageEditLink();
        });
    </script>
</head>

<body>

    <div id="top-bar"></div>

    <div class="container" style="max-width: 1200px;">

    <a class="github-fork-ribbon right-top" href="https://github.com/apache/shiro" title="Fork me on GitHub">Fork me on GitHub</a>



    <div class="masthead">
        <p class="lead">
            <a href="./index.html">
                <img src="./assets/images/apache-shiro-logo.png" style="height:100px; width:auto; vertical-align: bottom; margin-top: 20px;">
            </a>
            <span class="tagline">Simple. Java. Security.</span>
            <a class="pull-right" href="https://www.apache.org/events/current-event.html">
                <img style="padding-top: 8px" src="https://www.apache.org/events/current-event-125x125.png"/>
            </a>
        </p>
    </div>



    <nav class="navbar navbar-default" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse"
                    data-target="#navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li><a href="./get-started.html">Get Started</a></li>
                <li><a href="./documentation.html">Docs</a></li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        Web Apps <b class="caret"></b>
                    </a>

                    <ul class="dropdown-menu">
                        <li><a href="./web.html">General</a></li>
                        <li class="divider"></li>
                        <li><a href="./web-features.html">Features</a></li>
                    </ul>
                </li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        Integrations <b class="caret"></b>
                    </a>

                    <ul class="dropdown-menu">
                        <li><a href="./spring-boot.html">Spring</a></li>
                        <li><a href="./guice.html">Guice</a></li>
                        <li class="divider"></li>
                        <li><a href="./integration.html">Third-Party Integrations</a></li>
                    </ul>
                </li>

                <li><a href="./features.html">Features</a></li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        Community <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="./forums.html">Community Forums</a></li>
                        <li><a href="./mailing-lists.html">Mailing Lists</a></li>
                        <li><a href="./articles.html">Articles</a></li>
                        <li><a href="./news.html">News</a></li>
                        <li><a href="./events.html">Events</a></li>
                        <li class="divider"></li>
                        <li><a href="./community.html">More</a></li>
                    </ul>
                </li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        About <b class="caret"></b>
                    </a>

                    <ul class="dropdown-menu">
                        <li><a href="./about.html">About</a></li>
                        <li><a href="./security-reports.html">Vulnerability Reports</a></li>
                    </ul>
                </li>

            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li class="dropdown">
                    <a href="http://www.apache.org/" class="dropdown-toggle" data-toggle="dropdown">
                        Apache Software Foundation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="http://www.apache.org/">Apache Homepage</a></li>
                        <li><a href="http://www.apache.org/licenses/">License</a></li>
                        <li><a href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                        <li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
                        <li><a href="http://www.apache.org/security/">Security</a></li>
                    </ul>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </nav>


            <a name="Guice-IntegratingApacheShirointoGuicebasedApplication"></a>
<h1><a href="#integrating-apache-shiro-into-guice-based-application" name="integrating-apache-shiro-into-guice-based-application">Integrating Apache Shiro into Guice based Application</a></h1>
<p>Shiro <a href="https://github.com/google/guice">Guice</a> integration was added in Shiro 1.2. This page covers the ways to integrate Shiro into Guice-based applications using standard Guice conventions and mechanisms. Prior to reading this integration document, you should be a least somewhat familiar with Guice.</p>
<a name="Guice-Overview"></a>
<h2><a href="#overview" name="overview">Overview</a></h2>
<p>shiro-guice provides three Guice modules that can be included in your application.</p>
<ul>
  <li>
    <p>ShiroModule</p>
    <ul>
      <li>Provides basic integration for setting up the <code>SecurityManager</code>, any <code>Realms</code>, and any other Shiro configuration.</li>
      <li>This module is used by extending it and adding your own custom configuration.</li>
    </ul>
  </li>
  <li>
    <p>ShiroWebModule</p>
    <ul>
      <li>Extension of <code>ShiroModule</code> that sets up the web environment and also allows for filter chain configuration. This uses the <a href="https://github.com/google/guice/wiki/ServletModule">Guice Servlet Module</a> to configure the filters, and so requires that to be setup.</li>
      <li>Like the <code>ShiroModule</code>, this module is used by extending it and adding your own custom configuration.</li>
    </ul>
  </li>
  <li>
    <p>ShiroAopModule</p>
    <ul>
      <li>Uses <a href="https://github.com/google/guice/wiki/AOP">Guice AOP</a> to implement the Shiro AOP annotations. This module is primarily concerned with adapting Shiro <code>AnnotationMethodInterceptors</code> to the Guice method interceptor model.</li>
      <li>This module is typically used by simply installing it. However, if you have your own <code>AnnotationMethodInterceptors</code> written for Shiro, they can be easily incorporated by extending it.</li>
    </ul>
  </li>
</ul>
<a name="Guice-GettingStarted"></a>
<h2><a href="#getting-started" name="getting-started">Getting Started</a></h2>
<p>The most simple configuration is to extend <code>ShiroModule</code> to install your own <code>Realm</code>.</p>
<pre><code class="java">class MyShiroModule extends ShiroModule {
    protected void configureShiro() {
        try {
            bindRealm().toConstructor(IniRealm.class.getConstructor(Ini.class));
        } catch (NoSuchMethodException e) {
            addError(e);
        }
    }

    @Provides
    Ini loadShiroIni() {
        return Ini.fromResourcePath(&quot;classpath:shiro.ini&quot;);
    }
}
</code></pre>
<p>In this case, user and role configuration would go in the <code>shiro.ini</code> file.</p>
<div class="alert alert-warning">
    <span class="glyphicon glyphicon-warning-sign"></span> <strong>shiro.ini usage in Guice</strong>
    <hr class="message-inner-separator">
    <p>It is important to note that, in this above configuration, only the `users` and `roles` sections from the ini file are used.</p>
</div>
<p>Then, the module is used to create a Guice injector, and the injector is used to obtain a <code>SecurityManager</code>. The following example serves the same purpose as the first three lines in the <a href="10-minute-tutorial.html#10MinuteTutorial-Quickstart.java">Quickstart</a> example.</p>
<pre><code class="java">Injector injector = Guice.createInjector(new MyShiroModule());
SecurityManager securityManager = injector.getInstance(SecurityManager.class);
SecurityUtils.setSecurityManager(securityManager);
</code></pre>
<a name="Guice-AOP"></a>
<h2><a href="#aop" name="aop">AOP</a></h2>
<p>Shiro includes several annotations and method interceptors useful for performing authorization via AOP. It also provides a simple API for writing Shiro-specific method interceptors. shiro-guice supports this with the <code>ShiroAopModule</code>.</p>
<p>To use it, simply instantiate and install the module alongside your application module and your <code>ShiroModule</code>.</p>
<pre><code class="java">Injector injector = Guice.createInjector(new MyShiroModule(), new ShiroAopModule(), new MyApplicationModule());
</code></pre>
<p>If you have written custom interceptors that conform to Shiro&rsquo;s api, you may find it useful to extend the <code>ShiroAopModule</code>.</p>
<pre><code class="java">class MyShiroAopModule extends ShiroAopModule {
    protected void configureInterceptors(AnnotationResolver resolver)
    {
        bindShiroInterceptor(new MyCustomAnnotationMethodInterceptor(resolver));
    }
}
</code></pre>
<a name="Guice-Web"></a>
<h2><a href="#web" name="web">Web</a></h2>
<p>shiro-guice&rsquo;s web integration is designed to integrate Shiro and its filter paradigm with Guice&rsquo;s servlet module. If you are using Shiro in a web environment, and using Guice&rsquo;s servlet module, then you should extend ShiroWebModule rather than ShiroModule. Your web.xml should be setup exactly as Guice&rsquo;s servlet module recommends.</p>
<pre><code class="java">class MyShiroWebModule extends ShiroWebModule {
    MyShiroWebModule(ServletContext sc) {
        super(sc);
    }

    protected void configureShiroWeb() {
        try {
            bindRealm().toConstructor(IniRealm.class.getConstructor(Ini.class));
        } catch (NoSuchMethodException e) {
            addError(e);
        }

        addFilterChain(&quot;/public/**&quot;, ANON);
        addFilterChain(&quot;/stuff/allowed/**&quot;, AUTHC_BASIC, config(PERMS, &quot;yes&quot;));
        addFilterChain(&quot;/stuff/forbidden/**&quot;, AUTHC_BASIC, config(PERMS, &quot;no&quot;));
        addFilterChain(&quot;/**&quot;, AUTHC_BASIC);
    }

    @Provides
    Ini loadShiroIni() {
        return Ini.fromResourcePath(&quot;classpath:shiro.ini&quot;);
    }
}
</code></pre>
<p>In the previous code, we have bound an <code>IniRealm</code> and setup four filter chains. These chains would be equivalent to the following ini configuration.</p>
<pre><code class="ini">[urls]
/public/** = anon
/stuff/allowed/** = authcBasic, perms[&quot;yes&quot;]
/stuff/forbidden/** = authcBasic, perms[&quot;no&quot;]
/** = authcBasic
</code></pre>
<p>In shiro-guice, the filter names are Guice keys. All of the default Shiro filters are available as constants, but you are not limited to those. In order to use a custom filter in a filter chain, you would do</p>
<pre><code class="java">Key customFilter = Key.get(MyCustomFilter.class);

addFilterChain(&quot;/custom/**&quot;, customFilter);
</code></pre>
<p>We still have to tell guice-servlets about our Shiro filter. Since the <code>ShiroWebModule</code> is private, and guice-servlets does not give us a way to expose a filter mapping, we have to bind it manually.</p>
<pre><code class="java">ShiroWebModule.guiceFilterModule()
</code></pre>
<p>Or, from within an application module,</p>
<pre><code class="java">ShiroWebModule.bindGuiceFilter(binder())
</code></pre>
<a name="Guice-Properties"></a>
<h2><a href="#properties" name="properties">Properties</a></h2>
<p>A number of Shiro classes expose configuration parameters via setter methods. shiro-guice will inject these if it finds a binding for <code>@Named(&quot;shiro.{propName}&quot;)</code>. For instance, to set the session timeout, you could do the following.</p>
<pre><code class="java">bindConstant().annotatedWith(Names.named(&quot;shiro.globalSessionTimeout&quot;)).to(30000L);
</code></pre>
<p>If this paradigm doesn&rsquo;t work for you, you may also consider using a provider to instantiate the object and invoking the setters directly.</p>
<a name="Guice-InjectionofShiroObjects"></a>
<h2><a href="#injection-of-shiro-objects" name="injection-of-shiro-objects">Injection of Shiro Objects</a></h2>
<p>shiro-guice uses a Guice <code>TypeListener</code> to perform injection on native Shiro classes (any class in a subdirectory of <code>org.apache.shiro</code> but not <code>org.apache.shiro.guice</code>). However, Guice only considers explicitly bound types as candidates for <code>TypeListeners</code>, so if you have a Shiro object that you want injected, you have to declare it explicitly. For instance, to set the <code>CredentialsMatcher</code> for a realm, we would need to add the following bindings:</p>
<pre><code class="java">bind(CredentialsMatcher.class).to(HashedCredentialsMatcher.class);
bind(HashedCredentialsMatcher.class);
bindConstant().annotatedWith(Names.named(&quot;shiro.hashAlgorithmName&quot;)).to(Md5Hash.ALGORITHM_NAME);
</code></pre>
<h2><a name="Lendahandwithdocumentation"></a>Lend a hand with documentation </h2>
<p>While we hope this documentation helps you with the work you're doing with Apache Shiro, the community is improving and expanding the documentation all the time.  If you'd like to help the Shiro project, please consider correcting, expanding, or adding documentation where you see a need. Every little bit of help you provide expands the community and in turn improves Shiro. </p>
<p>The easiest way to contribute your documentation is to submit a pull-request by clicking on the <code>Edit</code> link below, or send it to the <a href="mailing-lists.html" title="Mailing Lists">User Mailing List</a>.</p>
<input type="hidden" id="ghEditPage" value="guice.md.vtl"></input>
    
</div>

    <div class="footer-padding"></div>
    <footer class="custom-footer">

        <div class="col-md-5">
            <div class="copyright-footer">
            <a href="http://www.apache.org/foundation/contributing.html">Donate to the ASF</a> |
            <a href="http://www.apache.org/licenses/LICENSE-2.0.html">License</a>
            <p>Copyright &copy; 2008-2021 The Apache Software Foundation</p>
                </div>
        </div>

        <div class="social col-md-2">
            <a class="btn btn-social-icon btn-sm btn-twitter" target="_blank" href="https://twitter.com/ApacheShiro"><span class="fa fa-twitter"></span></a>
            <a class="btn btn-social-icon btn-sm btn-facebook" target="_blank" href="https://www.facebook.com/ApacheShiro"><span class="fa fa-facebook"></span></a>
            <a class="btn btn-social-icon btn-sm btn-linkedin" target="_blank" href="https://www.linkedin.com/groups/4382576"><span class="fa fa-linkedin"></span></a>
        </div>


        <div class="col-md-2"></div>
        <div class="col-md-2 editThisPage">
            <div class="footer-shield"></div>
        </div>

    </footer> <!--END FOOTER-->

</body>
</html>
