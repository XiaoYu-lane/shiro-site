<!--
   Licensed to the Apache Software Foundation (ASF) under one or more
   contributor license agreements.  See the NOTICE file distributed with
   this work for additional information regarding copyright ownership.
   The ASF licenses this file to You under the Apache License, Version 2.0
   (the "License"); you may not use this file except in compliance with
   the License.  You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-  2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
-->
<html>




























<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="Apache Shiro is a powerful and easy-to-use Java security framework that performs authentication, authorization, cryptography, and session management.">
    <meta name="google-site-verification" content="QIax6uT5UX3enoU0G8Pz2pXbQ45KaQuHZ3nCh9V27mw">
    <meta name="google-site-verification" content="ecFap6dWJgS_GCCtxmJQJ_nFYQhM6EgSpBPZDU7xsCE">
    <meta name="msvalidate.01" content="0B57EB46CBFAD8FD45008D2DB6B6C68C">
    <meta name="y_key" content="e47896cd6bae4920">
    <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml">

    <title>
                    Apache Shiro | Simple. Java. Security.
        </title>


    <link rel="icon" type="image/vnd.microsoft.icon" href="./assets/images/favicon.ico">
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">

    <!-- site styles and  -->
    <link rel="stylesheet" type="text/css" href="./assets/css/style.css">
    <script type="text/javascript" src="./assets/js/shiro-site.js"></script>

    <!-- github ribbon -->
    <link rel="stylesheet" href="./assets/css/gh-pages/gh-fork-ribbon.css" />
    <!--[if lt IE 9]>
      <link rel="stylesheet" href="./assets/css/gh-pages/gh-fork-ribbon.ie.css" />
    <![endif]-->

    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>

    <!-- bootstrap -->
    <link rel="stylesheet" href="./assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="./assets/bootstrap/css/bootstrap-theme.min.css">
    <script src="./assets/bootstrap/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="./assets/css/bootstrap-social.css">

    <!-- Google Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXX-Y', 'auto');
    ga('send', 'pageview');
    </script>
    <!-- End Google Analytics -->



    <!-- syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/styles/default.min.css" integrity="sha256-Zd1icfZ72UBmsId/mUcagrmN7IN5Qkrvh75ICHIQVTk=" crossorigin="anonymous" />
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/highlight.min.js" integrity="sha256-s63qpgPYoQk+wv3U6WZqioVJrwFNBTgD4dkeegLuwvo=" crossorigin="anonymous"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <script type="text/javascript">

        $( document ).ready(function() {
            addPageEditLink();
        });
    </script>
</head>

<body>

    <div id="top-bar"></div>

    <div class="container" style="max-width: 1200px;">

    <a class="github-fork-ribbon right-top" href="https://github.com/apache/shiro" title="Fork me on GitHub">Fork me on GitHub</a>



    <div class="masthead">
        <p class="lead">
            <a href="./index.html">
                <img src="./assets/images/apache-shiro-logo.png" style="height:100px; width:auto; vertical-align: bottom; margin-top: 20px;">
            </a>
            <span class="tagline">Simple. Java. Security.</span>
            <a class="pull-right" href="https://www.apache.org/events/current-event.html">
                <img style="padding-top: 8px" src="https://www.apache.org/events/current-event-125x125.png"/>
            </a>
        </p>
    </div>



    <nav class="navbar navbar-default" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse"
                    data-target="#navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li><a href="./get-started.html">Get Started</a></li>
                <li><a href="./documentation.html">Docs</a></li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        Web Apps <b class="caret"></b>
                    </a>

                    <ul class="dropdown-menu">
                        <li><a href="./web.html">General</a></li>
                        <li class="divider"></li>
                        <li><a href="./web-features.html">Features</a></li>
                    </ul>
                </li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        Integrations <b class="caret"></b>
                    </a>

                    <ul class="dropdown-menu">
                        <li><a href="./spring-boot.html">Spring</a></li>
                        <li><a href="./guice.html">Guice</a></li>
                        <li class="divider"></li>
                        <li><a href="./integration.html">Third-Party Integrations</a></li>
                    </ul>
                </li>

                <li><a href="./features.html">Features</a></li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        Community <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="./forums.html">Community Forums</a></li>
                        <li><a href="./mailing-lists.html">Mailing Lists</a></li>
                        <li><a href="./articles.html">Articles</a></li>
                        <li><a href="./news.html">News</a></li>
                        <li><a href="./events.html">Events</a></li>
                        <li class="divider"></li>
                        <li><a href="./community.html">More</a></li>
                    </ul>
                </li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        About <b class="caret"></b>
                    </a>

                    <ul class="dropdown-menu">
                        <li><a href="./about.html">About</a></li>
                        <li><a href="./security-reports.html">Vulnerability Reports</a></li>
                    </ul>
                </li>

            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li class="dropdown">
                    <a href="http://www.apache.org/" class="dropdown-toggle" data-toggle="dropdown">
                        Apache Software Foundation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="http://www.apache.org/">Apache Homepage</a></li>
                        <li><a href="http://www.apache.org/licenses/">License</a></li>
                        <li><a href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                        <li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
                        <li><a href="http://www.apache.org/security/">Security</a></li>
                    </ul>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </nav>


            <ul>
  <li><a href="#Version2Brainstorming-RenameAuthenticationInfotoAccount">Rename AuthenticationInfo to Account</a></li>
  <li><a href="#Version2Brainstorming-Realmrefactoring">Realm refactoring</a></li>
  <li><a href="#Version2Brainstorming-Splitshirocoreintomodules">Split shiro-core into modules</a></li>
  <li><a href="#Version2Brainstorming-Eventdrivendesign">Event-driven design</a></li>
  <li><a href="#Version2Brainstorming-SubjectPrincipalCollection">Subject PrincipalCollection</a></li>
  <li><a href="#Version2Brainstorming-ComponentNames">Component Names</a></li>
  <li><a href="#Version2Brainstorming-AuthorizationANTLRGrammar">Authorization ANTLR Grammar</a></li>
  <li><a href="#Version2Brainstorming-AuthorizationRequest%2FResponse">AuthorizationRequest/Response</a></li>
  <li><a href="#Version2Brainstorming-ReinforcecustomizationviaOODelegation%28compositionoverinheritance%29">Reinforce customization via OO Delegation (composition over inheritance)</a></li>
  <li><a href="#Version2Brainstorming-MultiStageAuthenticationviarequest%2Fresponse">Multi-Stage Authentication via request/response</a></li>
  <li><a href="#Version2Brainstorming-CaptchaSupport">Captcha Support</a></li>
  <li><a href="#Version2Brainstorming-Configurationperfilterinstanceandnopathmatching">Configuration per filter instance and no path matching</a></li>
  <li><a href="#Version2Brainstorming-Webmodulerepackaging.">Web module repackaging.</a></li>
</ul>
<p>There is currently no timeline for a version 2, but this space represents any brainstorming efforts that the community wishes to address that may be major feature enhancements that can&rsquo;t be backwards compatible. Typically discussions from the dev list resulting in some form of consensus will probably make it into this page. Actionable items will go into Jira, potentially referencing this page for clarity.</p>
<ul>
  <li>(I know this isn&rsquo;t a feature but its equally is not more important) Deeper and more accessible documentation and how-tos.</li>
  <li>management system for long lived hashes</li>
  <li>token/ticket system</li>
  <li>more generalized way to handle unauthorized exceptions</li>
  <li>lower level crypto toolkit to facilitate customizations</li>
  <li>unauthorizedUrl per path filter</li>
</ul>
<a name="Version2Brainstorming-RenameAuthenticationInfotoAccount"></a>
<h3><a href="#rename-authenticationinfo-to-account" name="rename-authenticationinfo-to-account">Rename AuthenticationInfo to Account</a></h3>
<p>The existing <code>AuthenticationInfo</code> name is less intuitive and is essentially the same thing.</p>
<a name="Version2Brainstorming-Realmrefactoring"></a>
<h3><a href="#realm-refactoring" name="realm-refactoring">Realm refactoring</a></h3>
<p>Most Realms differ little in their implementations - mostly by the protocols they use. Create a &lsquo;DefaultRealm&rsquo; implementation (or something similar) that allows pluggable AccountResolver and AuthorizationResolver interfaces that abstract away interaction with the data stores and the rest of the internal Realm logic (e.g. authc and authz caching, etc) can be shared by most Realm implementation.</p>
<a name="Version2Brainstorming-Splitshirocoreintomodules"></a>
<h3>Split shiro-core into modules</h3>
<p>Maybe shiro-core should be split up into separate modules (e.g. shiro-crypto, shiro-authc, shiro-authz, etc) if possible. This may or may not be possible due to the tight integration of APIs (e.g. Shiro authentication depends on shiro hashing (crypto) etc). A cursory investigation should be made if possible.</p>
<a name="Version2Brainstorming-Eventdrivendesign"></a>
<h3>Event-driven design</h3>
<p><strong>This can be in 1.3+ as these would be all new packages/classes and do not require signature changes to existing code</strong></p>
<p>Utilize events significantly and more effectively. Base on Akka&rsquo;s event model and <a href="http://code.google.com/p/guava-libraries/wiki/EventBusExplained">Guava&rsquo;s EventBus</a>. This enables ideal loose coupling/high cohesion plugins/integration/customization.</p>
<p>Package: <code>org.apache.shiro.event</code></p>
<p>Potential classes:</p>
<pre><code class="java">public class ShiroEvent extends EventObject {

    private final long timestamp; //millis since Epoch (UTC time zone). 
    public ShiroEvent(Object source) {
        super(source);
        this.timestamp = new Date().getTime();
    }

    public long getTimestamp() {
        return timestamp;
    }
}
</code></pre>
<pre><code class="java"><br/>public interface Publisher {

    void publish(Object event);
}
</code></pre>
<pre><code class="java">/** Marker annotation for a method that wishes to receive a particular event instance. */
public @interface Subscribe {
}
</code></pre>
<pre><code class="java">/** 
  * Listener implementations just annotate a method as @Subscribe.  
  * The single method argument determines the type of event received.
  */
public class MyListener {

    @Subscribe
    public void doSomething(SomeEvent event) {
        ...
    }
}
</code></pre>
<pre><code class="java">public interface SubscriberRegistry {

    void register(Object subscriber);

    void unregister(Object subscriber);
}
</code></pre>
<p>An EventBus can be created based on Publisher + SubscriberRegistry:</p>
<pre><code class="java">public class SynchronousEventBus implements Publisher, SubscriberRegistry {
    ...
}
</code></pre>
<a name="Version2Brainstorming-SubjectPrincipalCollection"></a>
<h3><a href="#subject-principalcollection" name="subject-principalcollection">Subject PrincipalCollection</a></h3>
<p>Convert this to be a sub-interface of Map with additional per-Realm utility methods.</p>
<p>See the <a href="https://github.com/apache/shiro/blob/main/core/src/main/java/org/apache/shiro/subject/PrincipalMap.java">PrincipalMap</a> concept for ideas (experimental, not referenced in Shiro 1.x at the moment).</p>
<p>Maybe rename this to &lsquo;attributes&rsquo;? i.e. <code>subject.getAttributes()</code>?</p>
<a name="Version2Brainstorming-ComponentNames"></a>
<h3><a href="#component-names" name="component-names">Component Names</a></h3>
<p>Change classes named FooDAO to FooStore instead.</p>
<a name="Version2Brainstorming-AuthorizationANTLRGrammar"></a>
<h3><a href="#authorization-antlr-grammar" name="authorization-antlr-grammar">Authorization ANTLR Grammar</a></h3>
<p>Ideally, we can have a single annotation:</p>
<pre><code class="java">@Secured(&quot;authz expression here&quot;)
public void someMethod(){...}
</code></pre>
<p>Where the &lsquo;authz expression here&rsquo; is authorization assertion statement backed by an ANTLR lexer/parser, for example:</p>
<pre><code class="java">@Secured(&quot;(role(admin) || role(developer)) || perm(account:12345:open)&quot;)
</code></pre>
<p>This would translate the expression into the relevant hasRole/isPermitted calls.</p>
<a name="Version2Brainstorming-AuthorizationRequest%2FResponse"></a>
<h3><a href="#authorizationrequest-response" name="authorizationrequest-response">AuthorizationRequest/Response</a></h3>
<p>Employing the same grammar as mentioned above, instead of multiple subject.isPermitted/hasRole calls, the same thing could be achieved with an AuthorizationRequest/Response scheme. For example:</p>
<pre><code class="java">AuthorizationRequest request = //create request w/ expression
AuthorizationResponse response = subject.authorize(authorizationRequest);
if (response.isAuthorized()) {
...
} else {
...
}
</code></pre>
<a name="Version2Brainstorming-ReinforcecustomizationviaOODelegation%28compositionoverinheritance%29"></a>
<h3>Reinforce customization via OO Delegation (composition over inheritance)</h3>
<ul>
  <li>Any of the features provided by PathMatchingFilter would be provided for any configured filter via a proxy mechanism. The proxy would likely support the PathMatchingFilter features, setting request attributes as necessary for the wrapped filter to react to. This eliminates the need to subclass PathMatchingFilter to utilize these features.</li>
  <li>The same principal would be probably be applied for realms. A DefaultRealm could be created that delegates to an AuthenticationInfoAccessor and AuthorizationInfoAccessor (or whatever we want to call them) that performs the same behavior as AuthenticatingRealm#doGetAuthenticationInfo and AuthorizingRealm#doGetAuthorizationInfo. The end result is no more subclassing realms for 95% of use cases, and instead providing accessors.</li>
</ul>
<a name="Version2Brainstorming-MultiStageAuthenticationviarequest%2Fresponse"></a>
<h3>Multi-Stage Authentication via request/response</h3>
<p>In applications that need to authenticate via multiple mechanisms (e.g. multi-factor authentication), a Request/Response protocol for login would probably be easier to use to support such workflows. For example:</p>
<pre><code class="java">LoginRequest request = //create login request 
LoginResponse response = subject.login(request);
if (!response.isComplete()) {
    LoginRequest secondRequest = response.nextRequest();
    //populate w/ data for 2nd phase
   response = subject.login(secondRequest);
}
if (response.hasException()) {
    throw response.getException();
}
...
</code></pre>
<p>Additionally probably change the Authenticator signature to be as follows:</p>
<pre><code class="java">AuthenticationResult authenticate(AuthenticationRequest) throws AuthenticationException;
</code></pre>
<a name="Version2Brainstorming-CaptchaSupport"></a>
<h3><a href="#captcha-support" name="captcha-support">Captcha Support</a></h3>
<p>Captcha support would assist in human being verification (during login, during form submission, etc).</p>
<a name="Version2Brainstorming-Configurationperfilterinstanceandnopathmatching"></a>
<h3><a href="#configuration-per-filter-instance-and-no-path-matching" name="configuration-per-filter-instance-and-no-path-matching">Configuration per filter instance and no path matching</a></h3>
<a name="Version2Brainstorming-filterperinstance"></a>
<p><a href="https://issues.apache.org/jira/browse/SHIRO-256">SHIRO-256</a> is opened for this and <a href="http://tynamo.org">Tynamo.org</a> already has an implementation for it. This would both simplify the filter logic and result in better performance.</p>
<a name="Version2Brainstorming-Webmodulerepackaging."></a>
<h3>Web module repackaging.</h3>
<p>The Web module is largely Servlet-specific at the moment. As such, its packaging should reflect this, in the same way that all other support modules are named, e.g.<br/>module name: <code>shiro-servlet</code><br/>package base: <code>org.apache.shiro.servlet.*</code><br/><input type="hidden" id="ghEditPage" value="version-2-brainstorming.md"></input></p>
    
</div>

    <div class="footer-padding"></div>
    <footer class="custom-footer">

        <div class="col-md-5">
            <div class="copyright-footer">
            <a href="http://www.apache.org/foundation/contributing.html">Donate to the ASF</a> |
            <a href="http://www.apache.org/licenses/LICENSE-2.0.html">License</a>
            <p>Copyright &copy; 2008-2021 The Apache Software Foundation</p>
                </div>
        </div>

        <div class="social col-md-2">
            <a class="btn btn-social-icon btn-sm btn-twitter" target="_blank" href="https://twitter.com/ApacheShiro"><span class="fa fa-twitter"></span></a>
            <a class="btn btn-social-icon btn-sm btn-facebook" target="_blank" href="https://www.facebook.com/ApacheShiro"><span class="fa fa-facebook"></span></a>
            <a class="btn btn-social-icon btn-sm btn-linkedin" target="_blank" href="https://www.linkedin.com/groups/4382576"><span class="fa fa-linkedin"></span></a>
        </div>


        <div class="col-md-2"></div>
        <div class="col-md-2 editThisPage">
            <div class="footer-shield"></div>
        </div>

    </footer> <!--END FOOTER-->

</body>
</html>
