<!--
   Licensed to the Apache Software Foundation (ASF) under one or more
   contributor license agreements.  See the NOTICE file distributed with
   this work for additional information regarding copyright ownership.
   The ASF licenses this file to You under the Apache License, Version 2.0
   (the "License"); you may not use this file except in compliance with
   the License.  You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-  2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
-->
<html>




























<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="Apache Shiro is a powerful and easy-to-use Java security framework that performs authentication, authorization, cryptography, and session management.">
    <meta name="google-site-verification" content="QIax6uT5UX3enoU0G8Pz2pXbQ45KaQuHZ3nCh9V27mw">
    <meta name="google-site-verification" content="ecFap6dWJgS_GCCtxmJQJ_nFYQhM6EgSpBPZDU7xsCE">
    <meta name="msvalidate.01" content="0B57EB46CBFAD8FD45008D2DB6B6C68C">
    <meta name="y_key" content="e47896cd6bae4920">
    <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml">

    <title>
                    Apache Shiro | Simple. Java. Security.
        </title>


    <link rel="icon" type="image/vnd.microsoft.icon" href="./assets/images/favicon.ico">
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">

    <!-- site styles and  -->
    <link rel="stylesheet" type="text/css" href="./assets/css/style.css">
    <script type="text/javascript" src="./assets/js/shiro-site.js"></script>

    <!-- github ribbon -->
    <link rel="stylesheet" href="./assets/css/gh-pages/gh-fork-ribbon.css" />
    <!--[if lt IE 9]>
      <link rel="stylesheet" href="./assets/css/gh-pages/gh-fork-ribbon.ie.css" />
    <![endif]-->

    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>

    <!-- bootstrap -->
    <link rel="stylesheet" href="./assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="./assets/bootstrap/css/bootstrap-theme.min.css">
    <script src="./assets/bootstrap/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="./assets/css/bootstrap-social.css">

    <!-- Google Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXX-Y', 'auto');
    ga('send', 'pageview');
    </script>
    <!-- End Google Analytics -->



    <!-- syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/styles/default.min.css" integrity="sha256-Zd1icfZ72UBmsId/mUcagrmN7IN5Qkrvh75ICHIQVTk=" crossorigin="anonymous" />
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/highlight.min.js" integrity="sha256-s63qpgPYoQk+wv3U6WZqioVJrwFNBTgD4dkeegLuwvo=" crossorigin="anonymous"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <script type="text/javascript">

        $( document ).ready(function() {
            addPageEditLink();
        });
    </script>
</head>

<body>

    <div id="top-bar"></div>

    <div class="container" style="max-width: 1200px;">

    <a class="github-fork-ribbon right-top" href="https://github.com/apache/shiro" title="Fork me on GitHub">Fork me on GitHub</a>



    <div class="masthead">
        <p class="lead">
            <a href="./index.html">
                <img src="./assets/images/apache-shiro-logo.png" style="height:100px; width:auto; vertical-align: bottom; margin-top: 20px;">
            </a>
            <span class="tagline">Simple. Java. Security.</span>
            <a class="pull-right" href="https://www.apache.org/events/current-event.html">
                <img style="padding-top: 8px" src="https://www.apache.org/events/current-event-125x125.png"/>
            </a>
        </p>
    </div>



    <nav class="navbar navbar-default" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse"
                    data-target="#navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li><a href="./get-started.html">Get Started</a></li>
                <li><a href="./documentation.html">Docs</a></li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        Web Apps <b class="caret"></b>
                    </a>

                    <ul class="dropdown-menu">
                        <li><a href="./web.html">General</a></li>
                        <li class="divider"></li>
                        <li><a href="./web-features.html">Features</a></li>
                    </ul>
                </li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        Integrations <b class="caret"></b>
                    </a>

                    <ul class="dropdown-menu">
                        <li><a href="./spring-boot.html">Spring</a></li>
                        <li><a href="./guice.html">Guice</a></li>
                        <li class="divider"></li>
                        <li><a href="./integration.html">Third-Party Integrations</a></li>
                    </ul>
                </li>

                <li><a href="./features.html">Features</a></li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        Community <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="./forums.html">Community Forums</a></li>
                        <li><a href="./mailing-lists.html">Mailing Lists</a></li>
                        <li><a href="./articles.html">Articles</a></li>
                        <li><a href="./news.html">News</a></li>
                        <li><a href="./events.html">Events</a></li>
                        <li class="divider"></li>
                        <li><a href="./community.html">More</a></li>
                    </ul>
                </li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        About <b class="caret"></b>
                    </a>

                    <ul class="dropdown-menu">
                        <li><a href="./about.html">About</a></li>
                        <li><a href="./security-reports.html">Vulnerability Reports</a></li>
                    </ul>
                </li>

            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li class="dropdown">
                    <a href="http://www.apache.org/" class="dropdown-toggle" data-toggle="dropdown">
                        Apache Software Foundation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="http://www.apache.org/">Apache Homepage</a></li>
                        <li><a href="http://www.apache.org/licenses/">License</a></li>
                        <li><a href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                        <li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
                        <li><a href="http://www.apache.org/security/">Security</a></li>
                    </ul>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </nav>


            

<!-- spacer allows enough room to display the header -->
<div id="spacer" style="width: 0; height: 60px; float: left"></div>

<!-- related content (if any) -->
    <div style="border-style: solid; border-width: 2px; border-color: navy; padding: 5px; margin-left: 20px; margin-bottom: 20px; width:275px; float: right; clear: both; ">
      <h2>Related Content</h2>
                    <h3><a href="java-authorization-guide.html">Java Authorization Guide</a></h3>
            <p>Learn how Shiro handles access control in Java.</br><span style="font-size:11"><a href="java-authorization-guide.html">Read More &gt;&gt;</a></span></p>
                    <h3><a href="webapp-tutorial.html">Web App Tutorial</a></h3>
            <p>Step-by-step tutorial for securing a web application with Shiro.</br><span style="font-size:11"><a href="webapp-tutorial.html">Read More &gt;&gt;</a></span></p>
                    <h3><a href="get-started.html">Getting Started</a></h3>
            <p>Resources, guides and tutorials for new Shiro users.</br><span style="font-size:11"><a href="get-started.html">Read More &gt;&gt;</a></span></p>
                    <h3><a href="10-minute-tutorial.html">10-Minute Shiro Tutorial</a></h3>
            <p>Try Apache Shiro for yourself in under 10 minutes.</br><span style="font-size:11"><a href="10-minute-tutorial.html">Read More &gt;&gt;</a></span></p>
          </div>
  <h1><a name="Permissions-UnderstandingPermissionsinApacheShiro"></a>Understanding Permissions in Apache Shiro</h1>
<p>Shiro defines a Permission as a statement that defines an explicit behavior or action. It is a statement of raw functionality in an application and nothing more. Permissions are the lowest-level constructs in security polices, and they explicitly define only &ldquo;what&rdquo; the application can do.</p>
<p>They do <em>not</em> at all describe &ldquo;who&rdquo; is able to perform the action(s).</p>
<p>Some examples of permissions:</p>
<ul>
  <li>Open a file</li>
  <li>View the &lsquo;/user/list&rsquo; web page</li>
  <li>Print documents</li>
  <li>Delete the &lsquo;jsmith&rsquo; user</li>
</ul>
<p>Defining &ldquo;who&rdquo; (users) is allowed to do &ldquo;what&rdquo; (permissions) is an exercise of assigning permissions to users in some way. This is always done by the application&rsquo;s data model and can vary greatly across applications.</p>
<p>For example, permissions can be grouped in a Role and that Role could be associated with one or more User objects. Or some applications can have a Group of users and a Group can be assigned a Role, which by transitive association would mean that all the Users in that Group are implicitly granted the permissions in the Role.</p>
<p>There are many variations for how permissions could be granted to users - the application determines how to model this based on the application requirements.</p>
<a name="Permissions-WildcardPermissions"></a>
<h2><a href="#wildcard-permissions" name="wildcard-permissions">Wildcard Permissions</a></h2>
<p>The above examples of permissions, &ldquo;Open a file&rdquo;, &ldquo;View the &lsquo;user/list&rsquo; web page&rdquo;, etc are all valid permission statements. However, it would be very difficult computationally to interpret those natural language strings and determine if a user is allowed to perform that behavior or not.</p>
<p>So to enable easy-to-process yet still readable permission statements, Shiro provides powerful and intuitive permission syntax we refer to as the WildcardPermission.</p>
<a name="Permissions-SimpleUsage"></a>
<h3><a href="#simple-usage" name="simple-usage">Simple Usage</a></h3>
<p>Let&rsquo;s say you want to protect access to your company&rsquo;s printers such that some people can print to particular printers, while others can query what jobs are currently in the queue.</p>
<p>An extremely simple approach would be to grant the user a &ldquo;queryPrinter&rdquo; permission. Then you could check to see if the user has the queryPrinter permission by calling:</p>
<pre><code class="java">subject.isPermitted(&quot;queryPrinter&quot;)
</code></pre>
<p>This is (mostly) equivalent to</p>
<pre><code class="java">subject.isPermitted( new WildcardPermission(&quot;queryPrinter&quot;) )
</code></pre>
<p>but more on that later.</p>
<p>The simple permission string may work for simple applications, but it requires you to have permissions like &ldquo;printPrinter&rdquo;, &ldquo;queryPrinter&rdquo;, &ldquo;managePrinter&rdquo;, etc. You can also grant a user &quot;*&quot; permissions using the wildcard character (giving this permission construct its name), which means they have <strong><em>all</em></strong> permissions across <em>the entire application</em>.</p>
<p>But using this approach there&rsquo;s no way to just say a user has &ldquo;all printer permissions&rdquo;. For this reason, Wildcard Permissions supports multiple <em>levels</em> of permissioning.</p>
<a name="Permissions-MultipleParts"></a>
<h3><a href="#multiple-parts" name="multiple-parts">Multiple Parts</a></h3>
<p>Wildcard Permissions support the concept of multiple <em>levels</em> or <em>parts</em>. For example, you could restructure the previous simple example by granting a user the permission</p>
<pre><code class="ini">printer:query
</code></pre>
<p>The colon in this example is a special character used to delimit the next part in the permission string.</p>
<p>In this example, the first part is the domain that is being operated on (<code>printer</code>) and the second part is the action (<code>query</code>) being performed. The other above examples would be changed to:</p>
<pre><code class="ini">printer:print
printer:manage
</code></pre>
<p>There is no limit to the number of parts that can be used, so it is up to your imagination in terms of ways that this could be used in your application.</p>
<a name="Permissions-MultipleValues"></a>
<h4><a href="#multiple-values" name="multiple-values">Multiple Values</a></h4>
<p>Each part can contain multiple values. So instead of granting the user both the &ldquo;printer:print&rdquo; and &ldquo;printer:query&rdquo; permissions, you could simply grant them one:</p>
<pre><code class="ini">printer:print,query
</code></pre>
<p>which gives them the ability to <code>print</code> and <code>query</code> printers. And since they are granted both those actions, you could check to see if the user has the ability to query printers by calling:</p>
<pre><code class="java">subject.isPermitted(&quot;printer:query&quot;)
</code></pre>
<p>which would return <code>true</code></p>
<a name="Permissions-AllValues"></a>
<h4><a href="#all-values" name="all-values">All Values</a></h4>
<p>What if you wanted to grant a user <em>all</em> values in a particular part? It would be more convenient to do this than to have to manually list every value. Again, based on the wildcard character, we can do this. If the <code>printer</code> domain had 3 possible actions (<code>query</code>, <code>print</code>, and <code>manage</code>), this:</p>
<pre><code class="ini">printer:query,print,manage
</code></pre>
<p>simply becomes this:</p>
<pre><code class="ini">printer:*
</code></pre>
<p>Then, <em>any</em> permission check for &ldquo;printer:XXX&rdquo; will return <code>true</code>. Using the wildcard in this way scales better than explicitly listing actions since, if you added a new action to the application later, you don&rsquo;t need to update the permissions that use the wildcard character in that part.</p>
<p>Finally, it is also possible to use the wildcard token in any part of a wildcard permission string. For example, if you wanted to grant a user the &ldquo;view&rdquo; action across <em>all</em> domains (not just printers), you could grant this:</p>
<pre><code class="ini">*:view
</code></pre>
<p>Then any permission check for &ldquo;foo:view&rdquo; would return <code>true</code></p>
<a name="Permissions-InstanceLevelAccessControl"></a>
<h3>Instance-Level Access Control</h3>
<p>Another common usage of wildcard permissions is to model instance-level Access Control Lists. In this scenario you use three parts - the first is the <em>domain</em>, the second is the <em>action</em>(s), and the third is the instance(s) being acted upon.</p>
<p>So for example you could have</p>
<pre><code class="ini">printer:query:lp7200
printer:print:epsoncolor
</code></pre>
<p>The first defines the behavior to <code>query</code> the <code>printer</code> with the ID <code>lp7200</code>. The second permission defines the behavior to <code>print</code> to the <code>printer</code> with ID <code>epsoncolor</code>. If you grant these permissions to users, then they can perform specific behavior on <em>specific instances</em>. Then you can do a check in code:</p>
<pre><code class="java">if ( SecurityUtils.getSubject().isPermitted(&quot;printer:query:lp7200&quot;) {
    // Return the current jobs on printer lp7200 }
}
</code></pre>
<p>This is an extremely powerful way to express permissions. But again, having to define multiple instance IDs for all printers does not scale well, particularly when new printers are added to the system. You can instead use a wildcard:</p>
<pre><code class="ini">printer:print:*
</code></pre>
<p>This does scale, because it covers any new printers as well. You could even allow access to all actions on all printers:</p>
<pre><code class="ini">printer:*:*
</code></pre>
<p>or all actions on a single printer:</p>
<pre><code class="ini">printer:*:lp7200
</code></pre>
<p>or even specific actions:</p>
<pre><code class="ini">printer:query,print:lp7200
</code></pre>
<p>The &rsquo;*&lsquo; wildcard and &rsquo;,&rsquo; sub-part separator can be used in any part of the permission.</p>
<a name="Permissions-MissingParts"></a>
<h4><a href="#missing-parts" name="missing-parts">Missing Parts</a></h4>
<p>One final thing to note about permission assignments: missing parts imply that the user has access to all values corresponding to that part. In other words,</p>
<pre><code class="ini">printer:print
</code></pre>
<p>is equivalent to</p>
<pre><code class="ini">printer:print:*
</code></pre>
<p>and</p>
<pre><code class="ini">printer
</code></pre>
<p>is equivalent to</p>
<pre><code class="ini">printer:*:*
</code></pre>
<p>However, you can only leave off parts from the <em>end</em> of the string, so this:</p>
<pre><code class="ini">printer:lp7200
</code></pre>
<p>is <strong><em>not</em></strong> equivalent to</p>
<pre><code class="ini">printer:*:lp7200
</code></pre>
<a name="Permissions-CheckingPermissions"></a>
<h2><a href="#checking-permissions" name="checking-permissions">Checking Permissions</a></h2>
<p>While permission assignments use the wildcard construct quite a bit (&ldquo;printer:print:*&rdquo; = print to any printer) for convenience and scalability, permission <strong>checks</strong> at runtime should <em>always</em> be based on the most specific permission string possible.</p>
<p>For example, if the user had a UI and they wanted to print a document to the <code>lp7200</code> printer, you <strong>should</strong> check if the user is permitted to do so by executing this code:</p>
<pre><code class="java">if ( SecurityUtils.getSubject().isPermitted(&quot;printer:print:lp7200&quot;) ) {
    //print the document to the lp7200 printer }
}
</code></pre>
<p>That check is very specific and explicitly reflects what the user is attempting to do at that moment in time.</p>
<p>The following however is much less ideal for a runtime check:</p>
<pre><code class="java">if ( SecurityUtils.getSubject().isPermitted(&quot;printer:print&quot;) ) {
    //print the document }
}
</code></pre>
<p>Why? Because the second example says &ldquo;You must be able to print to <strong>any</strong> printer for the following code block to execute&rdquo;. But remember that &ldquo;printer:print&rdquo; is equivalent to &ldquo;printer:print:*&rdquo;!</p>
<p>Therefore, this is an incorrect check. What if the current user does not have the ability to print to any printer, but they <strong>do</strong> have the ability to print to say, the <code>lp7200</code> and <code>epsoncolor</code> printers. Then the 2nd example above would never allow them to print to the <code>lp7200</code> printer even though they have been granted that ability!</p>
<p>So the rule of thumb is to use the most specific permission string possible when performing permission checks. Of course, the 2nd block above might be a valid check somewhere else in the application if you really did only want to execute the code block if the user was allowed to print to any printer (suspect, but possible). Your application will determine what checks make sense, but in general, the more specific, the better.</p>
<a name="Permissions-Implication%2CnotEquality"></a>
<h2><a href="#implication-not-equality" name="implication-not-equality">Implication, not Equality</a></h2>
<p>Why is it that runtime permission checks should be as specific as possible, but permission assignments can be a little more generic? It is because the permission checks are evaluated by <em>implication</em> logic - not equality checks.</p>
<p>That is, if a user is assigned the <code>user:*</code> permission, this <em>implies</em> that the user can perform the <code>user:view</code> action. The string &ldquo;user:*&rdquo; is clearly not equal to &ldquo;user:view&rdquo;, but the former implies the latter. &ldquo;user:*&rdquo; describes a superset of functionality of that defined by &ldquo;user:view&rdquo;.</p>
<p>To support implication rules, all permissions are translated in to object instances that implement the <code>org.apache.shiro.authz.Permission</code> interface. This is so that implication logic can be executed at runtime and that implication logic is often more complex than a simple string equality check. All of the wildcard behavior described in this document is actually made possible by the <code>org.apache.shiro.authz.permission.WildcardPermission</code> class implementation. Here are some more wildcard permission strings that show access by implication:</p>
<pre><code class="ini">user:*
</code></pre>
<p><em>implies</em> the ability to also delete a user:</p>
<pre><code class="ini">user:delete
</code></pre>
<p>Similarly,</p>
<pre><code class="ini">user:*:12345
</code></pre>
<p><em>implies</em> the ability to also update user account with ID 12345:</p>
<pre><code class="ini">user:update:12345
</code></pre>
<p>and</p>
<pre><code class="ini">printer
</code></pre>
<p><em>implies</em> the ability to print to any printer</p>
<pre><code class="ini">printer:print
</code></pre>
<a name="Permissions-PerformanceConsiderations"></a>
<h2><a href="#performance-considerations" name="performance-considerations">Performance Considerations</a></h2>
<p>Permission checks are more complex than a simple equals comparison, so runtime implication logic must execute for each assigned Permission. When using permission strings like the ones shown above, you&rsquo;re implicitly using Shiro&rsquo;s default <code>WildcardPermission</code> which executes the necessary implication logic.</p>
<p>Shiro&rsquo;s default behavior for Realm implementations is that, for every permission check (for example, a call to <code>subject.isPermitted</code>), <em>all</em> of the permissions assigned to that user (in their Groups, Roles, or directly assigned to them) need to be checked individually for implication. Shiro &lsquo;short circuits&rsquo; this process by returning immediately after the first successful check occurs to increase performance, but it is not a silver bullet.</p>
<p>This is usually extremely fast when users, roles and permissions are cached in memory when using a proper <a href="cachemanager.html" title="CacheManager">CacheManager</a>, which Shiro does support for Realm implementations. Just know that with this default behavior, as the number of permissions assigned to a user or their roles or groups increase, the time to perform the check will necessarily increase.</p>
<p>If a Realm implementor has a more efficient way of checking permissions and performing this implication logic, especially if based on the applicaton&rsquo;s data model, they should implement that as part of their Realm isPermitted* method implementations. The default Realm/WildcardPermission support exists to cover 80-90% of most use cases, but it might not be the best solution for applications that have massive amounts of permissions to store and/or check at runtime.</p>
<h1>lendAHandDoc()</h1>
<input type="hidden" id="ghEditPage" value="permissions.md"></input>    
</div>

    <div class="footer-padding"></div>
    <footer class="custom-footer">

        <div class="col-md-5">
            <div class="copyright-footer">
            <a href="http://www.apache.org/foundation/contributing.html">Donate to the ASF</a> |
            <a href="http://www.apache.org/licenses/LICENSE-2.0.html">License</a>
            <p>Copyright &copy; 2008-2021 The Apache Software Foundation</p>
                </div>
        </div>

        <div class="social col-md-2">
            <a class="btn btn-social-icon btn-sm btn-twitter" target="_blank" href="https://twitter.com/ApacheShiro"><span class="fa fa-twitter"></span></a>
            <a class="btn btn-social-icon btn-sm btn-facebook" target="_blank" href="https://www.facebook.com/ApacheShiro"><span class="fa fa-facebook"></span></a>
            <a class="btn btn-social-icon btn-sm btn-linkedin" target="_blank" href="https://www.linkedin.com/groups/4382576"><span class="fa fa-linkedin"></span></a>
        </div>


        <div class="col-md-2"></div>
        <div class="col-md-2 editThisPage">
            <div class="footer-shield"></div>
        </div>

    </footer> <!--END FOOTER-->

</body>
</html>
